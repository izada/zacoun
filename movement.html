<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Responsive Mechanical Watch Movement</title>
<style>
  html,body {
    margin:0;
    padding:0;
    width:100%;
    height:100%;
    background:#efe7df; /* calm nude background */
    overflow:hidden;
    cursor:none; /* hide cursor for screensaver effect */
  }
  canvas {
    display:block;
    width:100%;
    height:100%;
  }
</style>
</head>
<body>
<canvas id="c"></canvas>
<script>
// Setup
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
let DPR = window.devicePixelRatio || 1;
let W = window.innerWidth;
let H = window.innerHeight;

function resize() {
  W = window.innerWidth;
  H = window.innerHeight;
  DPR = window.devicePixelRatio || 1;
  canvas.width = W * DPR;
  canvas.height = H * DPR;
  ctx.setTransform(DPR,0,0,DPR,0,0);
}
window.addEventListener('resize', resize);
resize();

// Palette
const palette = {
  bg: '#efe7df',
  brass: '#b89260',
  brassDark: '#91724d',
  steel: '#c9c9cc',
  screw: '#7b7b7f',
};

// Gear drawing
function drawGear(x, y, r, teeth, rot, color, hole=0.25) {
  ctx.save();
  ctx.translate(x,y);
  ctx.rotate(rot);
  
  // Base gear disc
  ctx.beginPath();
  ctx.arc(0,0,r,0,Math.PI*2);
  ctx.fillStyle = color;
  ctx.fill();
  
  // Teeth
  const innerR = r * 0.88;
  for (let i=0;i<teeth;i++) {
    const a = (i / teeth) * Math.PI*2;
    const ax = Math.cos(a)*innerR;
    const ay = Math.sin(a)*innerR;
    ctx.beginPath();
    ctx.moveTo(ax, ay);
    ctx.lineTo(Math.cos(a)*(r+2), Math.sin(a)*(r+2));
    ctx.strokeStyle = color;
    ctx.lineWidth = 2;
    ctx.stroke();
  }
  
  // Center hole
  ctx.beginPath();
  ctx.arc(0,0,r*hole,0,Math.PI*2);
  ctx.fillStyle = palette.brassDark;
  ctx.fill();
  
  ctx.restore();
}

// Gear data (relative positions and sizes)
let gears = [
  {x:0.3, y:0.45, size:0.16, teeth:40, speed:-0.016, color:palette.steel},
  {x:0.55, y:0.54, size:0.09, teeth:30, speed:0.028, color:palette.brass},
  {x:0.75, y:0.34, size:0.06, teeth:22, speed:-0.05, color:palette.brass},
  {x:0.45, y:0.70, size:0.05, teeth:18, speed:-0.036, color:palette.brass},
  {x:0.17, y:0.30, size:0.06, teeth:20, speed:0.038, color:palette.brass},
  {x:0.82, y:0.72, size:0.04, teeth:16, speed:0.064, color:palette.brass},
];

// Parallax setup
let last = performance.now();
let mouseX = W/2, mouseY = H/2, px=0, py=0;

// Mouse and touch movement
window.addEventListener('mousemove', e => {
  mouseX = e.clientX;
  mouseY = e.clientY;
});
window.addEventListener('touchmove', e => {
  if (e.touches.length) {
    mouseX = e.touches[0].clientX;
    mouseY = e.touches[0].clientY;
  }
}, {passive:true});

// Fullscreen toggle
function toggleFull() {
  if (!document.fullscreenElement) {
    document.documentElement.requestFullscreen?.();
  } else {
    document.exitFullscreen?.();
  }
}
canvas.addEventListener('dblclick', toggleFull);
window.addEventListener('keydown', e => {
  if (e.key === 'f' || e.key === 'F') toggleFull();
});

// Animation loop
function animate(now) {
  const dt = (now - last) / 1000;
  last = now;
  
  // Background
  ctx.fillStyle = palette.bg;
  ctx.fillRect(0,0,W,H);

  // Smooth parallax
  const targetPx = (mouseX - W/2) / W * 20;
  const targetPy = (mouseY - H/2) / H * 20;
  px += (targetPx - px) * 0.05;
  py += (targetPy - py) * 0.05;

  // Draw each gear
  gears.forEach((g, i) => {
    g.rot = (g.rot || 0) + g.speed;
    const r = Math.min(W,H) * g.size;
    const gx = W*g.x - px * (i+1)*0.05;
    const gy = H*g.y - py * (i+1)*0.05;
    drawGear(gx, gy, r, g.teeth, g.rot, g.color);
  });

  requestAnimationFrame(animate);
}
requestAnimationFrame(animate);
</script>
</body>
</html>
